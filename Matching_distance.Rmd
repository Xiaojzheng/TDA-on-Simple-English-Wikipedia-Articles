---
title: "Matching_distance"
output: html_document
---

# This file contains code for Two-Sample t-Test on Matching Distance

### matching distance RIVET 20 bins
```{r}
### 6 random data sets
random.all<- c(0.05263730484,0.05263554452,0.05263555144,0.05263565845,0.05263554452,0.05263554452,0.05263566538)
null_mean<- c()
for (i in 1:100){
  samp<- sample(1:length(random.all),4)
  avg<- mean(random.all[samp])
  null_mean<- c(null_mean, avg)
}
hist(null_mean,20)
plot(density(null_mean))

### 50 random data sets
random.all<- c(0.052637304838865979, 0.05263554798287183, 0.052635658454797452, 0.052635661917669489, 0.052635665380037465, 0.05263555144507754, 0.052635661917333133, 0.052635654991077183, 0.052635547981816758, 0.052635544520139549, 0.052635658454797452, 0.05263554451909775, 0.052635551444813529, 0.052637308301975869, 0.052635551445341065, 0.052635651529730335, 0.052635551445473314, 0.052635887345161864, 0.05263566191800749, 0.052635541056233665, 0.05263554798287183, 0.052635887344897853, 0.05263566538003623, 0.052635654991077183, 0.052635654991077183, 0.052637304838995744, 0.052635547982344294, 0.10526434365903542, 0.052635665380205636, 0.052637304838865979, 0.052639866495013336, 0.05263554451831997, 0.052635547983004086, 0.052635551445736846, 0.0526355445200073, 0.052637308301975869, 0.052635661917333133, 0.052637308302334748, 0.05263554798287183, 0.052640450583449926, 0.052635544518015644, 0.052635544519111024, 0.052635654991077183, 0.052635661917669489, 0.052635654991077183, 0.052635661917501304, 0.052635654991077183, 0.052637301377972005, 0.052635551445473314, 0.052635547982608305)

random.all<- c(0.052637304838865979, 0.05263554798287183, 0.052635658454797452, 0.052635661917669489, 0.052635665380037465, 0.05263555144507754, 0.052635661917333133, 0.052635654991077183, 0.052635547981816758, 0.052635544520139549, 0.052635658454797452, 0.05263554451909775, 0.052635551444813529, 0.052637308301975869, 0.052635551445341065, 0.052635651529730335, 0.052635551445473314, 0.052635887345161864, 0.05263566191800749, 0.052635541056233665, 0.05263554798287183, 0.052635887344897853, 0.05263566538003623, 0.052635654991077183, 0.052635654991077183, 0.052637304838995744, 0.052635547982344294, 0.052635665380205636, 0.052637304838865979, 0.052639866495013336, 0.05263554451831997, 0.052635547983004086, 0.052635551445736846, 0.0526355445200073, 0.052637308301975869, 0.052635661917333133, 0.052637308302334748, 0.05263554798287183, 0.052640450583449926, 0.052635544518015644, 0.052635544519111024, 0.052635654991077183, 0.052635661917669489, 0.052635654991077183, 0.052635661917501304, 0.052635654991077183, 0.052637301377972005, 0.052635551445473314, 0.052635547982608305)


hist(random.all)

null_mean<- c()
for (i in 1:1000){
  samp<- sample(1:length(random.all),50, replace=T)
  avg<- mean(random.all[samp])
  null_mean<- c(null_mean, avg)
}
hist(null_mean,100,freq=F,xlab="Matching Distance", ylab="Frequency", main="Null distribution for matching distance")
lines(density(null_mean, adjust=2), col="darkgreen", lwd=3) 
abline(v=quantile(null_mean, 0.95),lty="dotted",col="red",lwd=2)
mtext(c("Low","High"),side=1,line=2,at=c(5,7))

h <- hist(null_mean, breaks = 100, plot=FALSE)
den<- h$counts/sum(h$counts)
hist(null_mean, breaks = 100,freq=F)
lines(h$mids,den,col="red")


lines(density(null_mean), col="darkgreen", lwd=3) 
abline(v=quantile(null_mean, 0.95),lty="dotted",col="red")
plot(density(null_mean),prob=T)

mean(null_mean)
sd(null_mean)

### one sided
quantile(null_mean, 0.95)


wiki<- c(0.36842053616836878, 0.36842145685023331, 0.36842097988480321, 0.36842155380322877, 0.36842155380511393, 0.36842135989917335, 0.36842145685211797, 0.36842135565294309, 0.36842140837563925, 0.36842093145000943, 0.36842089584858445, 0.36842079889575546, 0.3684208993733824, 0.36842150532860962, 0.36842116599343683, 0.36842089582315263, 0.36842108560211301, 0.36842126294439487, 0.36842085089516557, 0.36842137989810964, 0.36842152956686014, 0.36842155380511393, 0.36842137989810964, 0.36842152956497498, 0.36841982982695143, 0.36842052467350106, 0.36842089937149775, 0.3684223569029465, 0.36842179537165121, 0.36842209329380077, 0.36842157804148562, 0.36842100412302237, 0.36842100416760459, 0.36842135989728869, 0.36842152956686014, 0.36842181960992726, 0.36842133565906038, 0.36842157804337083, 0.36842181960992726, 0.36842181961685949, 0.36842140837563925, 0.36842155380322877, 0.36842053619903831, 0.36842155380511393, 0.36842155380511393, 0.36842157804337083, 0.36842082313632146, 0.36842150532672446, 0.36842077465991968, 0.36842116599343683, 0.36842070583568698, 0.36842116599155217, 0.36842300850970577, 0.36842150532672446, 0.36842031802490294, 0.36842126294439487, 0.36842221147223925, 0.36842152956686014, 0.36842235689955249, 0.36842093145000943, 0.36842155380511393, 0.36842131142272005, 0.36842106904064509, 0.36842143261199245, 0.36842128718449813, 0.36841919171591142, 0.3684214041294146, 0.36842143261199245, 0.36842155380511393, 0.36842152956686014, 0.36842059738104938, 0.36842152956686014, 0.36842157804337083, 0.36842157804337083, 0.36842152956686014, 0.36842097992643813, 0.36842100414236778, 0.36842100412302237, 0.36842160227974574, 0.36842101288748719, 0.36842077818069147, 0.36842070583568698, 0.36842203256356792, 0.36842155380511393, 0.36842121446985177,
0.36842121446985177, 0.36842152956686014, 0.36842157804337083, 0.36842157804337083, 0.36842152956686014, 0.36842097992643813, 0.36842100414236778, 0.36842100412302237, 0.36842160227974574, 0.36842101288748719, 0.36842077818069147, 0.36842070583568698, 0.36842203256356792, 0.36842155380511393, 0.36842121446985177)

length(wiki)
```

### matching distance RIVTE 40 bins
```{r}
random.all<- c(0.051280123180007846, 0.05128506115036871, 0.051286029648012897, 0.051283277109588576, 0.042837829171406223, 0.047398058004579892, 0.025645178775253272, 0.047398058004044799, 0.025645178775248082, 0.051286029645721973, 0.047392927235902119, 0.051285061150254947, 0.025645180419231865, 0.051286029647931365, 0.051285064437872625, 0.047392927236296553, 0.04017070204074491, 0.05128345896371557, 0.051283277111490881, 0.047398058003717609, 0.047395492620370197, 0.051285758906826122, 0.051285436708857338, 0.051285057862526233, 0.047398058003608128, 0.05128203291647588, 0.05128543344123096, 0.076920184771176486, 0.025645180419231865, 0.025647415770053684, 0.025649112840357386, 0.025645178775003916, 0.051285433441370994, 0.05110869423520388, 0.025645178775065988, 0.025647415770246908, 0.047392927235902119, 0.051286029647849028, 0.047396518772377487, 0.047398058003717602, 0.025645178775065988, 0.051285061150254947, 0.047398058003717602, 0.025645998636834266, 0.051285131632619975, 0.025645178775255812, 0.051285918634240597, 0.051287633904204523, 0.051285436727317078, 0.047395492619434661)

hist(random.all)

null_mean<- c()
for (i in 1:1000){
  samp<- sample(1:length(random.all),50, replace=T)
  avg<- mean(random.all[samp])
  null_mean<- c(null_mean, avg)
}
hist(null_mean,100,freq=F,xlab="Matching Distance", ylab="Frequency", main="Null distribution for matching distance")
lines(density(null_mean, adjust=2), col="darkgreen", lwd=3) 
abline(v=quantile(null_mean, 0.95),lty="dotted",col="red",lwd=2)
mtext(c("Low","High"),side=1,line=2,at=c(5,7))

mean(null_mean)
sd(null_mean)

### one sided
quantile(null_mean, 0.95)

wiki<- c(0.37179444049666438, 0.37179514978339301, 0.37179461564494681, 0.371794758640481, 0.37179545216380572, 0.37179533299864254, 0.35897466250753296, 0.371796039939014, 0.358976399639928, 0.3717967761449576, 0.37179545216380572, 0.37179526149958131, 0.37179444049767851, 0.3589763996409836, 0.35898694783335094, 0.35897774620412565, 0.35897423043602389, 0.35897406890964684, 0.3717967523096557, 0.37179540449773124, 0.35897537533759122, 0.37179540449868254)
```


### H1 matching distance
```{r}
random.all<- c(0.026317767066011837, 0.05262602321660155, 0.026317761871170655, 0.026317770529483267, 0.026317753214019544, 0.026317763603757413, 0.02631776706546405)

#random.all<- c(0.026317767066011837, 0.026317761871170655, 0.026317770529483267, 0.026317753214019544, 0.026317763603757413, 0.02631776706546405)

hist(random.all)

null_mean<- c()
for (i in 1:1000){
  samp<- sample(1:length(random.all),6, replace=T)
  avg<- mean(random.all[samp])
  null_mean<- c(null_mean, avg)
}
hist(null_mean,30,freq=F,xlab="Matching Distance", ylab="Frequency", main="Null distribution for matching distance")
lines(density(null_mean, adjust=2), col="darkgreen", lwd=3) 
abline(v=quantile(null_mean, 0.95),lty="dotted",col="red",lwd=2)
#mtext(c("Low","High"),side=1,line=2,at=c(5,7))


mean(null_mean)
sd(null_mean)

### one sided
quantile(null_mean, 0.95)


wiki<- c(0.078948379552714595, 0.052633079368633776, 0.052631459598085316, 0.052630863522306552, 0.052626685438336582, 0.052621268354548931, 0.078946076868128087, 0.078947439291137469, 0.052633397938133625, 0.052642915283775335, 0.052630479176139396, 0.05263044141418665, 0.07448394178153088, 0.052633051665974456, 0.052632116429217522)

```

### Distribution of bar lengths
```{r}
random1_bar<- c(rep(1.73951-0.102324,54),rep(1.63718-0.102324,1108),rep(1.53486-0.102324,819),rep(1.43253-0.102324,18))
random2_bar<- c(rep(1.73951-0.102324,69),rep(1.63718-0.102324,1074),rep(1.53486-0.102324,843),rep(1.43253-0.102324,13))
random3_bar<- c(rep(1.73949-0.102323,45),rep(1.73949-0.102324,7),rep(1.63717-0.102323,978),rep(1.63717-0.102324,49),rep(1.53485-0.102323,864),rep(1.53485-0.102324,7),rep(1.43252-0.102323,12),rep(1.43252-0.102324,1))
random4_bar<- c(rep(1.73951-0.102323,50),rep(1.63718-0.102324,1034),rep(1.53486-0.102323,902),rep(1.43253-0.102324,13))
random5_bar<- c(rep(1.73951-0.102323,50),rep(1.63718-0.102324,1092),rep(1.53486-0.102323,844),rep(1.43253-0.102324,13))
random_bar<- c(random1_bar,random2_bar,random3_bar,random4_bar,random5_bar)
hist(random_bar)

null_mean<- c()
for (i in 1:1000){
  samp<- sample(1:length(random_bar),9959, replace=T)
  avg<- mean(random_bar[samp])
  null_mean<- c(null_mean, avg)
}
hist(null_mean,30,freq=F,xlab="Matching Distance", ylab="Frequency", main="Null distribution for bar length")
lines(density(null_mean, adjust=2), col="darkgreen", lwd=3) 
abline(v=quantile(null_mean, 0.05),lty="dotted",col="red",lwd=2)

wiki1_bar<- c(rep(1.63718-0.102324,1),rep(1.53485-0.102324,86),rep(1.43253-0.102324,387),rep(1.33021-0.102324,478),rep(1.22788-0.102324,400),rep(1.12556-0.102324,201),rep(1.02324-0.102324,113),rep(0.920912-0.102324,67),rep(0.818589-0.102324,62),rep(0.716265-0.102324,50),rep(0.613942-0.102324,31),rep(0.511618-0.102324,34),rep(0.409294-0.102324,54),rep(0.306971-0.102324,35))

wiki2_bar<- c(rep(1.63715-0.102322,1),rep(1.53482-0.102322,81), rep(1.53482-0.102324,3),rep(1.4325-0.102322,343),rep(1.4325-0.102324,17),rep(1.33018-0.102322,464),rep(1.33018-0.102324,22),rep(1.22786-0.102322,366),rep(1.22786-0.102324,21),rep(1.12554-0.102322,229),rep(1.12554-0.102324,8),rep(1.02322-0.102322,101), rep(1.02322-0.102324,5), rep(0.920895-0.102322,61),rep(0.920895-0.102324,5), rep(0.818573-0.102322,56), rep(0.818573-0.102324,5), rep(0.716252-0.102322,50),	rep(0.716252-0.102324,3), rep(0.61393-0.102322,27), rep(0.61393-0.102324,4), rep(0.511608-0.102322,47), rep(0.511608-0.102324,3), rep(0.409287-0.102322,41), rep(0.409287-0.102324,3), rep(0.306965-0.102322,30), rep(0.204643-0.102322,2), rep(0.204643-0.102324,1))

wiki3_bar<- c(rep(-(0.102321-1.63714),1),rep(-(0.102324-1.63714),1), rep(-(0.102321-1.53482),91),rep(-(0.102324-1.53482),4), rep(-(0.102321-1.4325),339),rep(-(0.102324-1.4325),21), rep(-(0.102321-1.33018),456), rep(-(0.102324-1.33018),26), rep(-(0.102321-1.22786),339), rep(-(0.102324-1.22786),9), rep(-(0.102321-1.12554),221), rep(-(0.102324-1.12554),15), rep(-(0.102321-1.02321),123), rep(-(0.102324-1.02321),5), rep(-(0.102321-0.920893) ,75), rep(-(0.102324-0.920893),6), rep(-(0.102321-0.818572),64), rep(-(0.102324- 0.818572),2), rep(-(0.102321-0.71625),45), rep(-(0.102324-0.71625),4), rep(-c(0.102321-0.613929),39), rep(-c(0.102324-0.613929),2), rep(-(0.102321- 0.511607),28), rep(-(0.102324-0.511607),3), rep(-(0.102321-0.409286),48), rep	(-(0.102324-0.409286), 2), rep(-(0.102321-0.306964),30))

wiki4_bar<- c(rep(-(0.102324-1.63717),1), rep(-(0.102323-1.53484),75), rep(-(0.102324-1.53484),7), rep(-(0.102323-1.43252),373), rep(-(0.102324-1.43252),17), rep(-(0.102323-1.3302),472), rep(-(0.102324-1.3302 ), 22), rep(-(0.102323-1.22787),362), rep(-(0.102324-1.22787),22), rep(-(0.102323-1.12555), 217), rep(-(0.102324-1.12555),9), rep(-(0.102323-1.02323), 102), rep(-(0.102324-1.02323),6), rep(-(0.102323-0.920905),71), rep(-(0.102324-0.920905),6), rep(-(0.102323-0.818583), 44), rep(-(0.102324-0.818583),3), rep(-(0.102323-0.71626),56), rep(-(0.102324-0.71626), 1), rep(-(0.102323-0.613937) ,21), rep(-(0.102324-0.613937),1), rep(-(0.102323-0.511614),35), rep(-(0.102324- 0.511614),3), rep(-(0.102323-0.409291),38), rep(-(0.102324-0.409291),1), rep(-(0.102323-0.306968),33), rep(-(0.102324-0.306968),1))	

wiki5_bar<- c(rep(-(0.102323-1.63717),1), rep(-(0.102323-1.53485),95),rep(-(0.102324-1.53485),3), rep(-(0.102323-1.43252),351), rep(-(0.102324-1.43252),15), rep(-(0.102323-1.3302),452), rep(-(0.102324-1.3302),27), rep(-(0.102323-1.22788),370), rep(-(0.102324-1.22788),17), rep(-(0.102323-1.12556),202), rep(-(0.102324-1.12556),14), rep(-(0.102323-1.02323),119), rep(-(0.102324-1.02323),5), rep(-(0.102323-0.920909),76), rep(-(0.102324-0.920909),6), rep(-(0.102323-0.818586),62), rep(-(0.102324-0.818586),4), rep(-(0.102323-0.716262),40), rep(-(0.102324-0.716262),1), rep(-(0.102323-0.613939),30), rep(-(0.102324-0.613939),2), rep(-(0.102323-0.511616),31), rep(-(0.102324-0.511616),1), rep(-(0.102323-0.409293),32), rep(-(0.102324-0.409293),2), rep(-(0.102323-0.30697),37), rep(-(0.102324-0.30697),3),rep(-(0.102323-0.204646), 1))

wiki_bar<- c(wiki1_bar, wiki2_bar, wiki3_bar, wiki4_bar, wiki5_bar)

wiki_mean<- c()
for (i in 1:1000){
  samp<- sample(1:length(wiki_bar),9995, replace=T)
  avg<- mean(wiki_bar[samp])
  wiki_mean<- c(wiki_mean, avg)
}
hist(wiki_mean,30,freq=F,xlab="Matching Distance", ylab="Frequency", main="Null distribution for matching distance")
lines(density(wiki_mean, adjust=2), col="red", lwd=3) 
#abline(v=quantile(null_mean, 0.95),lty="dotted",col="red",lwd=2)

### Put both in the same plot
hist(wiki_mean,30,freq=F,xlab="Matching Distance", ylab="Frequency", main="Null distribution for matching distance",xlim=c(1.0,1.5))
lines(density(null_mean, adjust=2), col="darkgreen", lwd=3) 
abline(v=quantile(null_mean, 0.05),lty="dotted",col="red",lwd=2)

```